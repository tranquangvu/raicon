'use strict';Object.defineProperty(exports,'__esModule',{value:!0});var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a},_createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var BEFORE_EACH_ACTION='beforeEach',Raicon=function(){function a(b,c,d){_classCallCheck(this,a),this.targetController=b,this.handler=this.generateHandler(c),this.hasTurbolinks=d}return _createClass(a,null,[{key:'register',value:function f(b,c){var d=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];if(!b||!c)throw'[Raicon] Invalid arguments on register.';var e=new a(b,c,d);return e.setup(),e}}]),_createClass(a,[{key:'getTargetController',value:function a(){return this.targetController}},{key:'getHandler',value:function a(){return this.handler}},{key:'setup',value:function b(){var a=this.hasTurbolinks?'turbolinks:load':'DOMContentLoaded';document.addEventListener(a,this.onReady.bind(this))}},{key:'onReady',value:function a(){this.collectCurrentHandlerAttrs(),this.targetController===this.currentController&&(!!this.handler[BEFORE_EACH_ACTION]&&this.executeHandlerOnAction(BEFORE_EACH_ACTION),this.executeHandlerOnAction(this.currentAction))}},{key:'executeHandlerOnAction',value:function b(a){if(!this.handler||'function'!=typeof this.handler[a])throw'[Raicon] Invalid action '+a+' in handler for controller '+this.targetController+'.';a!==BEFORE_EACH_ACTION&&document.dispatchEvent(new Event('raicon:before:'+this.targetController+'#'+a)),this.handler[a](),a!==BEFORE_EACH_ACTION&&document.dispatchEvent(new Event('raicon:after:'+this.targetController+'#'+a))}},{key:'collectCurrentHandlerAttrs',value:function c(){var a=document,b=a.body;this.currentController=this.transformControllerName(b.getAttribute('data-raicon-controller')||''),this.currentAction=this.transformActionName(b.getAttribute('data-raicon-action')||'')}},{key:'generateHandler',value:function b(a){switch('undefined'==typeof a?'undefined':_typeof(a)){case'function':return new a;case'object':return a;default:throw'[Raicon] Invalid handler for controller '+this.targetController+'.';}}},{key:'transformControllerName',value:function c(a){var b=this;return a.split('/').map(function(a){return b.snakeToCamel(a)}).join('/')}},{key:'transformActionName',value:function b(a){return this.snakeToCamel(a)}},{key:'snakeToCamel',value:function b(a){return a.replace(/([-_][a-z])/g,function(a){return a.toUpperCase().replace('-','').replace('_','')})}}]),a}();exports.default=Raicon;